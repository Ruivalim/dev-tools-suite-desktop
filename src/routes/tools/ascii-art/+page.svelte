<script lang="ts">
	import { Type, Copy, Check, Trash2 } from 'lucide-svelte';
	import Select from '$lib/components/ui/Select.svelte';

	let input = $state('Hello');
	let output = $state('');
	let copied = $state(false);
	let selectedFont = $state('standard');

	// Simple ASCII art fonts
	const fonts: Record<string, Record<string, string[]>> = {
		standard: {
			A: ['  ___  ', ' / _ \\ ', '/ /_\\ \\', '|  _  |', '| | | |', '\\_| |_/'],
			B: ['______ ', '| ___ \\', '| |_/ /', '| ___ \\', '| |_/ /', '\\____/ '],
			C: [' _____ ', '/  __ \\', '| /  \\/', '| |    ', '| \\__/\\', ' \\____/'],
			D: ['______ ', '|  _  \\', '| | | |', '| | | |', '| |/ / ', '|___/  '],
			E: ['______ ', '|  ___|', '| |__  ', '|  __| ', '| |___ ', '\\____/ '],
			F: ['______ ', '|  ___|', '| |_   ', '|  _|  ', '| |    ', '\\_|    '],
			G: [' _____ ', '|  __ \\', '| |  \\/', '| | __ ', '| |_\\ \\', ' \\____/'],
			H: [' _   _ ', '| | | |', '| |_| |', '|  _  |', '| | | |', '\\_| |_/'],
			I: [' _____ ', '|_   _|', '  | |  ', '  | |  ', ' _| |_ ', '|_____|'],
			J: ['   ___ ', '  |_  |', '    | |', '    | |', '/\\__/ /', '\\____/ '],
			K: [' _   __', '| | / /', '| |/ / ', '|    \\ ', '| |\\  \\', '\\_| \\_/'],
			L: [' _     ', '| |    ', '| |    ', '| |    ', '| |____', '\\_____/'],
			M: ['___  ___', '|  \\/  |', '| .  . |', '| |\\/| |', '| |  | |', '\\_|  |_/'],
			N: [' _   _ ', '| \\ | |', '|  \\| |', '| . ` |', '| |\\  |', '\\_| \\_/'],
			O: [' _____ ', '|  _  |', '| | | |', '| | | |', '\\ \\_/ /', ' \\___/ '],
			P: ['______ ', '| ___ \\', '| |_/ /', '|  __/ ', '| |    ', '\\_|    '],
			Q: [' _____ ', '|  _  |', '| | | |', '| | | |', '\\ \\/' + '\\| |', ' \\_/\\__/'],
			R: ['______ ', '| ___ \\', '| |_/ /', '|    / ', '| |\\ \\ ', '\\_| \\_|'],
			S: [' _____ ', '/  ___|', '\\ `--. ', ' `--. \\', '/\\__/ /', '\\____/ '],
			T: [' _____ ', '|_   _|', '  | |  ', '  | |  ', '  | |  ', '  \\_/  '],
			U: [' _   _ ', '| | | |', '| | | |', '| | | |', '| |_| |', ' \\___/ '],
			V: ['_   _ ', '| | | |', '| | | |', '| | | |', '\\ \\_/ /', ' \\___/ '],
			W: ['_    _ ', '| |  | |', '| |  | |', '| |/\\| |', '\\  /\\  /', ' \\/  \\/ '],
			X: ['__   __', '\\ \\ / /', ' \\ V / ', ' /   \\ ', '/ /^\\ \\', '\\/   \\/'],
			Y: ['__   __', '\\ \\ / /', ' \\ V / ', '  | |  ', '  | |  ', '  \\_/  '],
			Z: ['______', '|___  /', '   / / ', '  / /  ', './ /___', '\\_____/'],
			' ': ['      ', '      ', '      ', '      ', '      ', '      '],
			'!': [' _ ', '| |', '| |', '| |', '|_|', '(_)'],
			'?': [' ___ ', '|__ \\', '  / /', ' |_| ', ' (_) ', '     '],
			'.': ['   ', '   ', '   ', '   ', ' _ ', '(_)'],
			',': ['   ', '   ', '   ', '   ', ' _ ', '( )'],
			'0': [' ___  ', '/ _ \\ ', '| | | |', '| | | |', '| |_| |', ' \\___/ '],
			'1': [' __  ', '/  | ', ' | | ', ' | | ', ' | | ', ' |_| '],
			'2': [' ___  ', '|__ \\ ', '  / / ', ' / /  ', '/ /__ ', '|____|'],
			'3': [' ___  ', '|__ \\ ', '  / / ', '  \\ \\ ', ' ___) |', '|____/ '],
			'4': [' _  _  ', '| || | ', '| || |_', '|__   _|', '   | |  ', '   |_|  '],
			'5': [' _____ ', '| ____|', '| |__  ', '|___ \\ ', ' ___) |', '|____/ '],
			'6': ['  __  ', ' / /  ', '/ /_  ', "| '_ \\ ", '| (_) |', ' \\___/ '],
			'7': [' _____ ', '|___  |', '   / / ', '  / /  ', ' / /   ', '/_/    '],
			'8': ['  ___  ', ' / _ \\ ', '| (_) |', ' > _ < ', '| (_) |', ' \\___/ '],
			'9': ['  ___  ', ' / _ \\ ', '| (_) |', ' \\__, |', '   / / ', '  /_/  ']
		},
		block: {
			A: ['█████', '█   █', '█████', '█   █', '█   █'],
			B: ['████ ', '█   █', '████ ', '█   █', '████ '],
			C: ['█████', '█    ', '█    ', '█    ', '█████'],
			D: ['████ ', '█   █', '█   █', '█   █', '████ '],
			E: ['█████', '█    ', '████ ', '█    ', '█████'],
			F: ['█████', '█    ', '████ ', '█    ', '█    '],
			G: ['█████', '█    ', '█  ██', '█   █', '█████'],
			H: ['█   █', '█   █', '█████', '█   █', '█   █'],
			I: ['█████', '  █  ', '  █  ', '  █  ', '█████'],
			J: ['█████', '   █ ', '   █ ', '█  █ ', '████ '],
			K: ['█   █', '█  █ ', '███  ', '█  █ ', '█   █'],
			L: ['█    ', '█    ', '█    ', '█    ', '█████'],
			M: ['█   █', '██ ██', '█ █ █', '█   █', '█   █'],
			N: ['█   █', '██  █', '█ █ █', '█  ██', '█   █'],
			O: ['█████', '█   █', '█   █', '█   █', '█████'],
			P: ['█████', '█   █', '█████', '█    ', '█    '],
			Q: ['█████', '█   █', '█ █ █', '█  █ ', '███ █'],
			R: ['█████', '█   █', '█████', '█  █ ', '█   █'],
			S: ['█████', '█    ', '█████', '    █', '█████'],
			T: ['█████', '  █  ', '  █  ', '  █  ', '  █  '],
			U: ['█   █', '█   █', '█   █', '█   █', '█████'],
			V: ['█   █', '█   █', '█   █', ' █ █ ', '  █  '],
			W: ['█   █', '█   █', '█ █ █', '██ ██', '█   █'],
			X: ['█   █', ' █ █ ', '  █  ', ' █ █ ', '█   █'],
			Y: ['█   █', ' █ █ ', '  █  ', '  █  ', '  █  '],
			Z: ['█████', '   █ ', '  █  ', ' █   ', '█████'],
			' ': ['     ', '     ', '     ', '     ', '     '],
			'!': ['  █  ', '  █  ', '  █  ', '     ', '  █  '],
			'?': ['█████', '    █', '  ██ ', '     ', '  █  '],
			'.': ['     ', '     ', '     ', '     ', '  █  '],
			',': ['     ', '     ', '     ', '  █  ', ' █   '],
			'0': ['█████', '█   █', '█   █', '█   █', '█████'],
			'1': [' ██  ', '  █  ', '  █  ', '  █  ', '█████'],
			'2': ['█████', '    █', '█████', '█    ', '█████'],
			'3': ['█████', '    █', '█████', '    █', '█████'],
			'4': ['█   █', '█   █', '█████', '    █', '    █'],
			'5': ['█████', '█    ', '█████', '    █', '█████'],
			'6': ['█████', '█    ', '█████', '█   █', '█████'],
			'7': ['█████', '    █', '   █ ', '  █  ', ' █   '],
			'8': ['█████', '█   █', '█████', '█   █', '█████'],
			'9': ['█████', '█   █', '█████', '    █', '█████']
		},
		mini: {
			A: [' _ ', '/_\\', '| |'],
			B: ['__ ', '|_)', '|_)'],
			C: [' _', '|_', '|_'],
			D: ['__ ', '| \\', '|_/'],
			E: [' _', '|_', '|_'],
			F: [' _', '|_', '|'],
			G: [' _ ', '|  ', '|_|'],
			H: ['   ', '|_|', '| |'],
			I: ['_', '|', '|'],
			J: [' _', ' |', '_|'],
			K: ['  ', '|/', '|\\'],
			L: ['  ', '| ', '|_'],
			M: ['    ', '|\\/|', '|  |'],
			N: ['   ', '|\\ |', '| \\|'],
			O: [' _ ', '| |', '|_|'],
			P: [' _ ', '|_)', '|  '],
			Q: [' _ ', '| |', ' \\|'],
			R: [' _ ', '|_)', '| \\'],
			S: [' _', '(_', '_)'],
			T: ['___', ' | ', ' | '],
			U: ['   ', '| |', '|_|'],
			V: ['   ', '\\ /', ' v '],
			W: ['    ', '|  |', '|/\\|'],
			X: ['   ', '\\/', '/\\'],
			Y: ['   ', '\\/ ', ' | '],
			Z: ['__', ' /', '/_'],
			' ': ['   ', '   ', '   '],
			'!': ['_', '!', '.'],
			'?': ['_ ', ' )', '. '],
			'.': [' ', ' ', '.'],
			',': [' ', ' ', ','],
			'0': [' _ ', '| |', '|_|'],
			'1': ['  ', ' |', ' |'],
			'2': [' _ ', ' _)', '|_ '],
			'3': ['__', '_)', '_)'],
			'4': ['   ', '|_|', '  |'],
			'5': [' _ ', '|_ ', ' _)'],
			'6': [' _ ', '|_ ', '|_)'],
			'7': ['__', ' /', '/ '],
			'8': [' _ ', '(_)', '(_)'],
			'9': [' _ ', '|_)', ' _)']
		}
	};

	const fontOptions = [
		{ value: 'standard', label: 'Standard' },
		{ value: 'block', label: 'Block' },
		{ value: 'mini', label: 'Mini' }
	];

	function generateArt() {
		if (!input.trim()) {
			output = '';
			return;
		}

		const font = fonts[selectedFont];
		const text = input.toUpperCase();
		const height = font['A'].length;
		const lines: string[] = Array(height).fill('');

		for (const char of text) {
			const charArt = font[char] || font[' '];
			for (let i = 0; i < height; i++) {
				lines[i] += charArt[i] || ' '.repeat(charArt[0]?.length || 1);
			}
		}

		output = lines.join('\n');
	}

	async function copyOutput() {
		if (!output) return;
		await navigator.clipboard.writeText(output);
		copied = true;
		setTimeout(() => (copied = false), 2000);
	}

	function clear() {
		input = '';
		output = '';
	}

	$effect(() => {
		generateArt();
	});
</script>

<div class="flex h-full flex-col">
	<!-- Header -->
	<div class="mb-4 flex items-center justify-between">
		<div class="flex items-center gap-3">
			<div class="rounded-lg bg-accent-500/10 p-2">
				<Type class="h-6 w-6 text-accent-500" />
			</div>
			<div>
				<h1 class="text-2xl font-bold text-slate-900 dark:text-slate-100">ASCII Art Generator</h1>
				<p class="text-sm text-slate-600 dark:text-slate-400">Convert text to ASCII art banners</p>
			</div>
		</div>
	</div>

	<!-- Controls -->
	<div class="mb-4 flex flex-wrap items-center gap-4">
		<div class="max-w-md flex-1">
			<input
				type="text"
				bind:value={input}
				placeholder="Enter text..."
				class="w-full rounded-lg border border-slate-200 bg-white px-4 py-2 text-slate-900 focus:ring-2 focus:ring-accent-500 focus:outline-none dark:border-slate-700 dark:bg-slate-800 dark:text-slate-100"
			/>
		</div>

		<div class="flex items-center gap-2">
			<span class="text-sm text-slate-500">Font:</span>
			<Select value={selectedFont} options={fontOptions.map((opt) => ({ value: opt.value, label: opt.label }))} onchange={(v) => (selectedFont = v)} searchable={false} class="w-32" />
		</div>

		<button onclick={copyOutput} disabled={!output} class="flex items-center gap-1.5 rounded-lg bg-accent-500 px-3 py-2 text-sm font-medium text-white hover:bg-accent-600 disabled:opacity-50">
			{#if copied}
				<Check class="h-4 w-4" />
				Copied!
			{:else}
				<Copy class="h-4 w-4" />
				Copy
			{/if}
		</button>

		<button onclick={clear} class="flex items-center gap-1.5 rounded-lg px-3 py-2 text-sm text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-800">
			<Trash2 class="h-4 w-4" />
			Clear
		</button>
	</div>

	<!-- Output -->
	<div class="flex-1 overflow-auto rounded-xl border border-slate-200 bg-slate-900 p-6 dark:border-slate-800 dark:bg-slate-950">
		<pre class="font-mono text-sm whitespace-pre text-accent-400">{output || 'Type something above...'}</pre>
	</div>
</div>
